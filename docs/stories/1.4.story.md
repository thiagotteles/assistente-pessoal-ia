# História 1.4: Knowledge-Base Compartilhada Básica

## Status
Approved

## História
**Como um** usuário que precisa de contexto histórico,
**Eu quero** que informações sejam salvas de forma inteligente e pesquisável,
**Para que** agentes diferentes possam acessar contexto relevante automaticamente.

## Critérios de Aceitação

1. Usar Knowledge-Base Manager do Épico 0 para persistência automática
2. Sistema completo de [[referências]] Obsidian com auto-linking
3. Auto-splitting de arquivos grandes para manter performance
4. Cross-referencing automático entre informações relacionadas
5. Integração completa com Obsidian para visualização em graph view

## Tarefas / Subtarefas

- [ ] Tarefa 1: Integrar Knowledge-Base Manager do Épico 0 (AC: 1)
  - [ ] Verificar implementação existente do Knowledge-Base Manager
  - [ ] Testar interfaces principais: `salvar_entrada()`, `recuperar_entrada()`
  - [ ] Validar persistência automática de informações
  - [ ] Configurar metadados YAML automáticos
  - [ ] Testar integração com todos os 5 agentes

- [ ] Tarefa 2: Implementar sistema completo de [[referências]] (AC: 2)
  - [ ] Configurar auto-linking para [[pessoas]]
  - [ ] Configurar auto-linking para [[projetos]]
  - [ ] Configurar auto-linking para [[conceitos]]
  - [ ] Implementar detecção automática de referências em texto
  - [ ] Testar criação automática de links bidirecionais

- [ ] Tarefa 3: Implementar auto-splitting de arquivos grandes (AC: 3)
  - [ ] Configurar limite de tamanho para arquivos (>2000 linhas)
  - [ ] Implementar splitting inteligente baseado em conteúdo
  - [ ] Manter referências [[]] após splitting
  - [ ] Criar sistema de navegação entre arquivos divididos
  - [ ] Testar performance após splitting

- [ ] Tarefa 4: Implementar cross-referencing automático (AC: 4)
  - [ ] Criar sistema de detecção de informações relacionadas
  - [ ] Implementar linking automático entre contextos similares
  - [ ] Configurar agrupamento de informações por projeto/pessoa
  - [ ] Criar timeline automático de eventos relacionados
  - [ ] Testar consistência de referências cruzadas

- [ ] Tarefa 5: Configurar integração completa com Obsidian (AC: 5)
  - [ ] Configurar vault válido em `knowledge-base/`
  - [ ] Otimizar configurações para graph view
  - [ ] Configurar plugins essenciais do Obsidian
  - [ ] Testar visualização de conexões no graph
  - [ ] Validar navegação por backlinks automáticos

## Notas para Desenvolvimento

### Contexto das Histórias Anteriores
Esta história depende de:
- **Story 1.1**: Estrutura de arquivos com knowledge-base/ configurada
- **Story 1.2**: Sistema de captura que alimenta a knowledge-base
- **Story 1.3**: Comandos slash dos agentes que utilizam a knowledge-base
- **Épico 0**: Knowledge-Base Manager já implementado

### Knowledge-Base Manager Existente
[Fonte: architecture/componentes.md]

**Responsabilidade**: Sistema inteligente de gerenciamento da base compartilhada com referências [[]] e splitting automático

**Interfaces principais já implementadas:**
- `salvar_entrada()` - Persiste nova informação com metadados automáticos
- `gerar_referencias_obsidian()` - Cria links [[]] para pessoas, projetos, conceitos
- `split_arquivo_grande()` - Divide arquivos >2000 linhas inteligentemente
- `manter_consistencia_links()` - Atualiza [[referências]] após mudanças
- `busca_semantica()` - Busca inteligente por contexto
- `timeline_automatico()` - Cronologia de eventos e decisões

**Dependências**: Sistema de arquivos, Git, Obsidian vault, Cross-Agent Intelligence

### Estrutura da Knowledge-Base
[Fonte: architecture/estrutura-de-arquivos-source-tree.md]

**Estrutura detalhada:**
```
knowledge-base/                  # "Segundo cérebro" compartilhado (Obsidian Vault)
├── decisoes/                    # Decisões técnicas e pessoais
│   ├── bounded-context-duvida.md          # [[Bounded Context]]
│   ├── arquitetura-monolitica-alpha.md   # [[Projeto Alpha]]
│   └── cache-redis-implementacao.md      # [[Cache Redis]]
├── contextos/                   # Contextos de reuniões e conversas
│   ├── reuniao-fabio-performance.md      # [[Fabio H]] + [[Projeto Alpha]]
│   ├── call-cliente-requirements.md      # [[Cliente XYZ]]
│   └── brainstorm-features-beta.md       # [[Sistema Beta]]
├── projetos/                    # Informações por projeto
│   ├── projeto-alpha/           # [[Projeto Alpha]]
│   │   ├── overview.md          # Visão geral do projeto
│   │   ├── team.md              # [[Fabio H]], [[Maria Santos]]
│   │   ├── decisions.md         # Decisões específicas
│   │   └── timeline.md          # Histórico e próximos passos
│   └── sistema-beta/            # [[Sistema Beta]]
│       ├── overview.md
│       └── architecture.md
└── pessoas/                     # Perfis de pessoas
    ├── fabio-h.md               # [[Fabio H]]
    ├── maria-santos.md          # [[Maria Santos]]
    └── joao-silva.md            # [[João Silva]]
```

### Modelos de Dados
[Fonte: architecture/modelos-de-dados.md]

**Knowledge Entry**:
```yaml
id: "unique-identifier"
type: "pessoa|projeto|decisao|contexto"
created: "2025-01-09T10:00:00"
updated: "2025-01-09T15:30:00"
tags: ["tag1", "tag2"]
source_agent: "organizador|secretaria|arquiteto|psicologo|mentor"
priority: "alta|media|baixa"
related_entries: ["id1", "id2"]
obsidian_refs: ["[[Pessoa]]", "[[Projeto]]"]
```

### Workflows de Processamento
[Fonte: architecture/workflows-centrais.md]

**Workflow 1: Processamento de Despejo com Referências [[]]**
- Detecção automática de pessoas, projetos e conceitos
- Criação de referências [[]] bidirecionais
- Categorização inteligente por tipo de informação
- Integração com graph view do Obsidian

**Workflow 2: Registro de Reunião com Links Automáticos**
- Identificação automática de participantes [[pessoas]]
- Linking com [[projetos]] relacionados
- Criação de contexto temporal
- Cross-referencing com decisões anteriores

### Padrões de Referências
[Fonte: architecture/padres-de-codificao.md]

**Regras de referências [[]]:**
- **Pessoas**: [[Nome Próprio]] (ex: [[João Silva]])
- **Projetos**: [[Nome do Projeto]] (ex: [[Projeto Alpha]])
- **Conceitos**: [[Conceito]] (ex: [[Cache Redis]])
- **Consistência**: Sempre usar o mesmo formato para a mesma entidade

### Stack Tecnológico para Knowledge-Base
[Fonte: architecture/tech-stack.md]

**Tecnologias principais:**
- **Obsidian**: Gerenciamento automático de [[links]] com graph view
- **Markdown**: Knowledge-base e persistência (CommonMark)
- **YAML**: Templates e configuração (versão 1.2)
- **Git**: Versionamento e backup (versão 2.40+)
- **Claude API**: IA para organização e splitting

### Integração com Agentes
Todos os 5 agentes devem utilizar a knowledge-base:
- **Organizador**: Salva informações categorizadas
- **Secretaria**: Acessa status de projetos e pessoas
- **Arquiteto**: Recupera histórico de decisões técnicas
- **Psicólogo**: Analisa padrões de humor e energia
- **Mentor**: Tracked metas de carreira e crescimento

### Localização de Arquivos
**Arquivos específicos desta história:**
- `knowledge-base/` - Diretório principal (configuração/validação)
- `knowledge-base/.obsidian/` - Configurações do Obsidian
- Subdiretórios: `decisoes/`, `contextos/`, `projetos/`, `pessoas/`
- Arquivos de exemplo para testar referências [[]]

### Performance e Splitting
**Configurações de performance:**
- Limite de 2000 linhas por arquivo
- Splitting inteligente baseado em seções
- Manutenção de referências [[]] após divisão
- Otimização para visualização em graph view

## Testing

### Padrões de Teste
Implementar testes básicos de:
- Funcionamento do Knowledge-Base Manager
- Criação automática de referências [[]]
- Auto-splitting de arquivos grandes
- Cross-referencing entre informações
- Integração com Obsidian vault

### Casos de Teste Específicos
- Teste de salvamento e recuperação de entradas
- Teste de detecção automática de [[referências]]
- Teste de splitting com arquivo >2000 linhas
- Teste de navegação no graph view do Obsidian
- Teste de consistência de links após mudanças

## Log de Mudanças
| Data | Versão | Descrição | Autor |
|------|---------|-----------|-------|
| 2025-09-26 | 1.0 | História criada a partir do Épico 1 | Bob (SM) |

## Registro do Agente de Desenvolvimento
*Esta seção será preenchida pelo agente de desenvolvimento durante a implementação*

### Modelo de Agente Usado
*A ser preenchido pelo agente de desenvolvimento*

### Referências de Log de Debug
*A ser preenchido pelo agente de desenvolvimento*

### Lista de Notas de Conclusão
*A ser preenchido pelo agente de desenvolvimento*

### Lista de Arquivos
*A ser preenchido pelo agente de desenvolvimento*

## Resultados do QA
*Resultados da revisão do Agente de QA serão adicionados aqui*