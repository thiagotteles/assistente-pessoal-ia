# Story 5.0: NPM Package e Instalador Interativo User-First

**Epic**: Epic 5 - NPM Package e ProduÃ§Ã£o User-First
**Status**: ğŸ”„ In Progress
**Prioridade**: Alta
**Estimativa**: 20 horas (~2.5 dias Ãºteis)

**NOTA**: Esta story Ã© o container do Epic 5. Veja `docs/prd/epic-5-npm-package-production.md` para breakdown detalhado em 8 sub-stories (5.1 a 5.8).

---

## ğŸ¯ Objetivo

Transformar o Assistente Pessoal IA de projeto de desenvolvimento em **produto end-user**, com instalaÃ§Ã£o NPM interativa similar ao BMAD method, permitindo seleÃ§Ã£o de agentes durante instalaÃ§Ã£o e contribuiÃ§Ã£o da comunidade via Pull Requests.

---

## ğŸ“‹ Contexto

**Problema Atual**:
- InstalaÃ§Ã£o complexa (`git clone` + setup manual)
- README focado em desenvolvedores
- 5 agentes instalados obrigatoriamente (sem flexibilidade)
- Comunidade nÃ£o pode contribuir agentes facilmente

**SoluÃ§Ã£o**:
- NPM package com `npx assistente-pessoal install`
- Instalador interativo com seleÃ§Ã£o de agentes (checkboxes)
- Monorepo com todos agentes (`src/agents/`)
- Community contribui via PR (workflow fork + PR)

**ReferÃªncia**: BMAD method (`npx bmad-method install`)

---

## ğŸ‘¥ Persona

**Marina, 34 anos**
- Desenvolvedora Full-Stack com TDAH
- ConfortÃ¡vel com terminal, mas quer simplicidade
- Quer valor imediato (< 5 minutos)
- Quote: *"Eu nÃ£o quero aprender outro sistema. SÃ³ quero que funcione."*

---

## ğŸ“– User Stories

### US 3.5.1: InstalaÃ§Ã£o NPM Simples

**Como** usuÃ¡rio final
**Quero** instalar com `npx assistente-pessoal install`
**Para** nÃ£o precisar fazer git clone e setup manual

**CritÃ©rios de AceitaÃ§Ã£o**:
- âœ… Comando `npx assistente-pessoal install` funciona
- âœ… Installer pergunta local de instalaÃ§Ã£o (default: `~/assistente-ia`)
- âœ… Installer pergunta nome do usuÃ¡rio
- âœ… InstalaÃ§Ã£o completa em < 2 minutos
- âœ… Feedback visual com spinners e emojis

---

### US 3.5.2: SeleÃ§Ã£o Interativa de Agentes

**Como** usuÃ¡rio
**Quero** escolher quais agentes instalar
**Para** ter apenas os relevantes para meu perfil

**CritÃ©rios de AceitaÃ§Ã£o**:
- âœ… Installer mostra lista de agentes disponÃ­veis (checkbox)
- âœ… Organizador (Sofia) Ã© obrigatÃ³rio e prÃ©-selecionado
- âœ… Agentes recomendados aparecem marcados por padrÃ£o
- âœ… Interface clara com Ã­cones, descriÃ§Ãµes e categorias
- âœ… Apenas agentes selecionados sÃ£o copiados para instalaÃ§Ã£o

**Interface Esperada**:
```
ğŸ¤– Escolha seus Agentes Especializados

â”â”â” AGENTES OFICIAIS â”â”â”

  [X] ğŸ“Š SecretÃ¡ria
      GestÃ£o executiva, agenda, status de projetos
      Recomendado para: Todos os perfis

  [ ] ğŸ—ï¸  Arquiteto (Marcus)
      Consultoria tÃ©cnica com confronto construtivo
      Recomendado para: Desenvolvedores, Tech Leads

  [X] ğŸ§  PsicÃ³logo (Dr. Helena)
      Suporte emocional especializado para TDAH
      Recomendado para: Pessoas com TDAH

(Use ESPAÃ‡O para selecionar, ENTER para confirmar)
```

---

### US 3.5.3: Gerenciamento PÃ³s-InstalaÃ§Ã£o

**Como** usuÃ¡rio
**Quero** adicionar/remover agentes depois da instalaÃ§Ã£o
**Para** adaptar meu assistente Ã s minhas necessidades

**CritÃ©rios de AceitaÃ§Ã£o**:
- âœ… `npx assistente-pessoal list` - listar agentes instalados
- âœ… `npx assistente-pessoal add <agente>` - adicionar agente
- âœ… `npx assistente-pessoal remove <agente>` - remover agente
- âœ… `npx assistente-pessoal available` - ver agentes disponÃ­veis
- âœ… Feedback claro com confirmaÃ§Ãµes e avisos

---

### US 3.5.4: ContribuiÃ§Ã£o de Agentes pela Comunidade

**Como** desenvolvedor da comunidade
**Quero** contribuir um agente customizado
**Para** compartilhar com outros usuÃ¡rios

**CritÃ©rios de AceitaÃ§Ã£o**:
- âœ… Agentes da comunidade vivem em `src/agents/community/`
- âœ… Template de agente documentado (`CONTRIBUTING-AGENTS.md`)
- âœ… Workflow: fork â†’ branch â†’ PR â†’ review â†’ merge
- âœ… Agent registry (`agents.json`) validado automaticamente
- âœ… Agentes aprovados aparecem no instalador automaticamente

---

### US 3.5.5: README User-First

**Como** usuÃ¡rio descobrindo o projeto
**Quero** entender rapidamente o valor e como instalar
**Para** decidir se quero usar

**CritÃ©rios de AceitaÃ§Ã£o**:
- âœ… Hero section com tagline impactante
- âœ… InstalaÃ§Ã£o em destaque (1 comando visÃ­vel)
- âœ… SeÃ§Ã£o "Por que usar?" antes de "Como usar?"
- âœ… BenefÃ­cios TDAH explicados com empatia
- âœ… Screenshots/GIFs do instalador e interface

---

## ğŸ—ï¸ Arquitetura TÃ©cnica

### Estrutura do RepositÃ³rio (Monorepo)

```
assistente-pessoal-ia/
â”œâ”€â”€ package.json                     # NPM package config
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ cli.js                       # npx entry point
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ installer/
â”‚   â”‚   â”œâ”€â”€ prompts.js               # Interactive prompts
â”‚   â”‚   â”œâ”€â”€ agent-selector.js        # Agent selection UI
â”‚   â”‚   â””â”€â”€ setup.js                 # Installation logic
â”‚   â””â”€â”€ agents/
â”‚       â”œâ”€â”€ agents.json              # â­ Agent registry
â”‚       â”œâ”€â”€ core/
â”‚       â”‚   â””â”€â”€ organizador/         # Required
â”‚       â”œâ”€â”€ official/
â”‚       â”‚   â”œâ”€â”€ secretaria/
â”‚       â”‚   â”œâ”€â”€ arquiteto/
â”‚       â”‚   â”œâ”€â”€ psicologo/
â”‚       â”‚   â””â”€â”€ mentor/
â”‚       â””â”€â”€ community/               # Community agents
â”‚           â”œâ”€â”€ financeiro/
â”‚           â””â”€â”€ designer/
â”œâ”€â”€ templates/                       # Base structure (no agents)
â”‚   â”œâ”€â”€ despejo/
â”‚   â”œâ”€â”€ knowledge-base/
â”‚   â””â”€â”€ .assistant/
â”‚       â””â”€â”€ agents/                  # Empty (populated during install)
â””â”€â”€ docs/
    â”œâ”€â”€ CONTRIBUTING-AGENTS.md       # How to contribute agents
    â””â”€â”€ UX-BRIEF-user-first.md       # UX guidelines
```

---

### Agent Registry (`src/agents/agents.json`)

```json
{
  "version": "1.0.0",
  "agents": {
    "core": [
      {
        "id": "organizador",
        "name": "Sofia",
        "title": "Organizador Inteligente",
        "icon": "ğŸ“‹",
        "description": "Processa despejo diÃ¡rio e organiza automaticamente",
        "required": true,
        "author": "oficial",
        "category": "essencial",
        "path": "src/agents/core/organizador"
      }
    ],
    "official": [
      {
        "id": "secretaria",
        "name": "SecretÃ¡ria",
        "icon": "ğŸ“Š",
        "description": "GestÃ£o executiva, agenda, status de projetos",
        "required": false,
        "recommended": true,
        "path": "src/agents/official/secretaria"
      },
      // ... outros agentes oficiais
    ],
    "community": [
      {
        "id": "financeiro",
        "name": "Consultor Financeiro",
        "icon": "ğŸ’°",
        "description": "GestÃ£o de finanÃ§as pessoais",
        "author": "joao-dev",
        "author_github": "https://github.com/joao-dev",
        "path": "src/agents/community/financeiro"
      }
    ]
  }
}
```

---

## ğŸ’» ImplementaÃ§Ã£o

### Fase 1: Core Installer (2-3 dias)

**Tarefas**:
1. Criar estrutura NPM package
   - `package.json` com `bin` entry point
   - `bin/cli.js` com commander.js
   - Dependencies: inquirer, chalk, ora, fs-extra

2. Implementar installer base
   - `src/installer/prompts.js` - perguntas bÃ¡sicas
   - `src/installer/setup.js` - cÃ³pia de arquivos
   - Feedback visual com spinners

3. Criar agent registry
   - `src/agents/agents.json` com metadados
   - ValidaÃ§Ã£o de schema JSON

4. Implementar agent selector
   - `src/installer/agent-selector.js`
   - Interface checkbox com inquirer
   - RecomendaÃ§Ãµes baseadas em perfil

5. Adaptar setup para copiar apenas selecionados
   - LÃ³gica de cÃ³pia seletiva
   - ValidaÃ§Ã£o de agentes instalados

**Deliverables**:
- âœ… `npx assistente-pessoal install` funcional
- âœ… SeleÃ§Ã£o interativa de agentes
- âœ… InstalaÃ§Ã£o customizada

---

### Fase 2: CLI Commands (1-2 dias)

**Tarefas**:
1. Implementar `list` command
   - Ler `.assistant/agents/` instalados
   - Formatar output com Ã­cones e descriÃ§Ãµes

2. Implementar `add <agent>` command
   - Validar agente existe no registry
   - Copiar para `.assistant/agents/`
   - Atualizar configuraÃ§Ã£o

3. Implementar `remove <agent>` command
   - Validar agente estÃ¡ instalado
   - ConfirmaÃ§Ã£o antes de remover
   - NÃ£o permitir remover core agents

4. Implementar `available` command
   - Mostrar todos agentes do registry
   - Indicar quais jÃ¡ estÃ£o instalados
   - Separar por categorias

5. Implementar `info <agent>` command
   - Mostrar detalhes completos do agente
   - README do agente
   - Autor e categoria

**Deliverables**:
- âœ… CLI completo com 5 comandos
- âœ… Help messages claros
- âœ… Error handling robusto

---

### Fase 3: Community Workflow (1 dia)

**Tarefas**:
1. Criar `CONTRIBUTING-AGENTS.md`
   - Template de estrutura de agente
   - Workflow de contribuiÃ§Ã£o (fork + PR)
   - Checklist de qualidade

2. Criar template de agente
   - `agent.yaml` template
   - `memory-template.yaml` template
   - `AUTHOR.md` template

3. Criar PR template para agentes
   - `.github/PULL_REQUEST_TEMPLATE/agent.md`
   - Checklist de review

4. CI validation
   - GitHub Action para validar `agents.json`
   - Validar estrutura de agentes
   - Check for duplicates

**Deliverables**:
- âœ… DocumentaÃ§Ã£o de contribuiÃ§Ã£o completa
- âœ… Templates prontos para uso
- âœ… CI validando PRs automaticamente

---

### Fase 4: MigraÃ§Ã£o de Agentes Existentes (1 dia)

**Tarefas**:
1. Mover agentes atuais
   - `.assistant-core/agents/organizador/` â†’ `src/agents/core/organizador/`
   - `.assistant-core/agents/secretaria/` â†’ `src/agents/official/secretaria/`
   - Arquiteto, PsicÃ³logo, Mentor para `official/`

2. Registrar em `agents.json`
   - Adicionar metadados completos
   - Definir categorias
   - Marcar recomendaÃ§Ãµes

3. Testar instalaÃ§Ã£o seletiva
   - Instalar diferentes combinaÃ§Ãµes
   - Validar slash commands funcionam
   - Testar add/remove de agentes

4. Update docs
   - Atualizar README principal
   - Criar screenshots do instalador
   - Atualizar USAGE.md

**Deliverables**:
- âœ… Todos agentes migrados
- âœ… Registry completo e validado
- âœ… DocumentaÃ§Ã£o atualizada

---

### Fase 5: UX Refinement (1 dia)

**Tarefas**:
1. Implementar feedback UX
   - Mensagens de erro amigÃ¡veis
   - Success messages motivacionais
   - Progress indicators claros

2. Criar README user-first
   - Hero section impactante
   - InstalaÃ§Ã£o em destaque
   - BenefÃ­cios TDAH com empatia

3. Criar USAGE.md progressivo
   - Quick Start (5 min)
   - Guia Completo
   - FAQ

4. Screenshots e GIFs
   - Processo de instalaÃ§Ã£o
   - SeleÃ§Ã£o de agentes
   - Comandos CLI

**Deliverables**:
- âœ… README user-first completo
- âœ… DocumentaÃ§Ã£o progressiva
- âœ… Assets visuais

---

## âœ… Acceptance Criteria (QA Gates)

### AC1: NPM Installation Works

```bash
$ npx assistente-pessoal install

# Expected:
âœ… Interactive installer launches
âœ… All prompts work correctly
âœ… Agent selection shows all available agents
âœ… Installation completes without errors
âœ… Success message shows installed agents
```

**Test**: `test-story-3.5-install.sh`

---

### AC2: Agent Selection Works

```bash
# Expected:
âœ… Organizador is pre-selected and disabled
âœ… Recommended agents are checked by default
âœ… Community agents appear in separate section
âœ… Space toggles selection, Enter confirms
âœ… Only selected agents are copied
```

**Test**: Manual + automated check of `.assistant/agents/` contents

---

### AC3: Post-Install Commands Work

```bash
$ npx assistente-pessoal list
âœ… Shows installed agents with icons

$ npx assistente-pessoal available
âœ… Shows all agents, marks installed ones

$ npx assistente-pessoal add arquiteto
âœ… Adds agent successfully

$ npx assistente-pessoal remove secretaria
âœ… Removes after confirmation
```

**Test**: `test-story-3.5-cli.sh`

---

### AC4: Community Contribution Works

```bash
# Expected workflow:
1. Fork repository
2. Create agent in src/agents/community/
3. Add to agents.json
4. Create PR
5. CI validates structure
6. After merge, agent appears in installer
```

**Test**: `test-story-3.5-community.sh` (validates structure)

---

### AC5: README is User-First

**Checklist**:
- âœ… Hero section in first 100 lines
- âœ… Installation command visible in first 200 lines
- âœ… "Por que usar?" before "Como usar?"
- âœ… TDAH benefits explained with empathy
- âœ… No git clone mentioned as primary install method
- âœ… Developer docs moved to CONTRIBUTING.md

**Test**: Manual review + readability metrics

---

## ğŸ“Š Success Metrics

**Installation**:
- â±ï¸ Time to install: < 2 minutes (target)
- ğŸ“¦ Installation size: < 20MB (only selected agents)
- ğŸ¯ User completion rate: > 95%

**Adoption**:
- ğŸ“ˆ README bounce rate: < 30% (users read > 50%)
- â­ GitHub stars increase: +50% in 30 days
- ğŸ’¬ Community PRs: At least 1 agent in 60 days

**Quality**:
- âœ… Zero installation errors in basic flow
- âœ… All commands work on Windows/Mac/Linux
- âœ… CI validates all agents before merge

---

## ğŸš§ Technical Dependencies

**NPM Packages Required**:
- `commander` - CLI framework
- `inquirer` - Interactive prompts
- `chalk` - Terminal colors
- `ora` - Spinners
- `fs-extra` - File operations
- `yaml` - YAML parsing

**Files to Create**:
- `bin/cli.js`
- `src/installer/prompts.js`
- `src/installer/agent-selector.js`
- `src/installer/setup.js`
- `src/agents/agents.json`
- `docs/CONTRIBUTING-AGENTS.md`

**Files to Modify**:
- `package.json` - add bin, dependencies
- `README.md` - complete rewrite (user-first)
- `docs/USAGE.md` - update with NPM install
- `.github/workflows/ci.yml` - add agent validation

---

## ğŸ”— Related Documents

- **Architecture**: `docs/architecture/agent-selector-monorepo.md`
- **UX Brief**: `docs/UX-BRIEF-user-first.md`
- **Current README**: `README.md` (to be replaced)
- **Setup Script**: `setup.sh` (to be deprecated)

---

## ğŸ“ Notes

**Breaking Changes**:
- Installation method changes from `git clone` to `npx install`
- `.assistant-core/` moves to `src/agents/` in repository
- User installations still use `.assistant/` folder

**Migration Plan**:
- Keep `setup.sh` working for backward compatibility
- Add deprecation notice in setup.sh
- Document migration path in README

**Future Enhancements** (Post-v1.0):
- Agent presets ("developer bundle", "student bundle")
- `doctor` command for health checks
- Auto-update mechanism for agents
- Agent ratings/reviews from community

---

## âœ… Definition of Done

- âœ… All 5 user stories implemented
- âœ… All 5 QA gates pass
- âœ… `npx assistente-pessoal install` works on Win/Mac/Linux
- âœ… README is user-first and compelling
- âœ… CONTRIBUTING-AGENTS.md complete
- âœ… CI validates agent structure
- âœ… Existing users can upgrade via Story 3.0 script
- âœ… Zero BMAD-specific references (generalized)

---

**Estimated Effort**: 6-7 days
**Priority**: Alta (enables user-first transformation)
**Epic**: Epic 3 - ExperiÃªncia e Sucesso do UsuÃ¡rio Final

---

**Created**: 2025-10-02
**Author**: Winston (Architect)
**Status**: ğŸ”„ In Progress
